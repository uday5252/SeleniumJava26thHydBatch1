import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;



public class Fourteen {

	public static void main(String[] args) throws SQLException {
		
		Connection conInfo = DriverManager
		.getConnection("jdbc:mysql://localhost:3306/employee_db",
		 "root", "root");
		
		String insertQuery = 
				"insert into employees values(1, 'Raju', 34)";
		
		Statement s = conInfo.createStatement();// automatically Statement object will be createment
		int rowCount = s.executeUpdate(insertQuery);
		System.out.println("Data is inserted successfully: "+rowCount);
	}

}

===========================================
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class Fifteen {

	public static void main(String[] args) throws SQLException {
		Connection conInfo = DriverManager
				.getConnection("jdbc:mysql://localhost:3306/employee_db",
				 "root", "root");
		
		String readData = "select * from employees where"
				+ " id = ?";
		
		PreparedStatement cq = 
				conInfo.prepareStatement(readData);
		
		cq.setInt(1, 100);
//		select * from employees where id = 1
		ResultSet rs = cq.executeQuery();
		
		while(rs.next())
		{
			int empId = rs.getInt(1);
			String empName = rs.getString(2);
			int empAge = rs.getInt(3);
			
			System.out.println(empId + " " + empName + " " + empAge);
		}
		
//				String insertQuery = 
//						"insert into "
//						+ "employees(id,name,age) values(?, ?, ?)";
//				
//				
//				PreparedStatement recievedCompiledQuery = 
//						conInfo.prepareStatement(insertQuery);
//				
//				recievedCompiledQuery.setInt(1, 100);
//				recievedCompiledQuery.setString(2, "Mark");
//				recievedCompiledQuery.setInt(3, 34);
//				
//				int rowCount = recievedCompiledQuery.executeUpdate();
//				System.out.println(rowCount);
	}

}

=========================
use employee_db;

create table employees(
id int primary key,
name varchar(30),
age int,
profilePic blob);



======================
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;

public class Sixteen {

	public static void main(String[] args) throws SQLException, FileNotFoundException {
		
		String imgPath = "C:\\Users\\udayk\\Downloads\\download.jpg";
		
		Connection conInfo = DriverManager
				.getConnection("jdbc:mysql://localhost:3306/employee_db",
				 "root", "root");
		
		String insertQuery = "insert into "
				+ "employees(id,name,age,profilePic)"
				+ " values(?, ?, ?, ?)";
		
		PreparedStatement compiledQuery = 
				conInfo.prepareStatement(insertQuery);
		
		compiledQuery.setInt(1, 100);
		compiledQuery.setString(2, "Raju");
		compiledQuery.setInt(3, 54);
		
		File f = new File(imgPath);
		
		FileInputStream fis = new FileInputStream(f);
		
		compiledQuery.setBinaryStream(4, fis);
		
		int rowCount = compiledQuery.executeUpdate();
		System.out.println(rowCount);
		
	}

}
=========================================
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class Seventeen {

	public static void main(String[] args) throws SQLException, IOException {
		
		Connection conInfo = DriverManager
				.getConnection("jdbc:mysql://localhost:3306/employee_db",
				 "root", "root");
		
		String readQuery = "select * from employees where id = ?";
		
		PreparedStatement compiledQuery = conInfo.prepareStatement(readQuery);
		
		compiledQuery.setInt(1, 100);
		
		ResultSet rs = compiledQuery.executeQuery();
		
		while(rs.next())
		{
			int empId = rs.getInt(1);
			String empName = rs.getString(2);
			int empAge = rs.getInt(3);
			
			File f = new File("output.jpg");
			FileOutputStream fos = new FileOutputStream(f);
			
			InputStream readBinaryData = 
					rs.getBinaryStream("profilePic");
			
//			readBinaryData ==> 2000 bytes
//			int data = readBinaryData.read();
//			
//			while(data != -1)
//			{
//			
//				fos.write(data);
//				data = readBinaryData.read();
//			}
			
//			==============================
			byte[] b = new byte[1024];
			
			int bytesCount = readBinaryData.read(b);

			
			while(bytesCount != -1)
			{
				fos.write(b); // write 1024 bytes to output.jpg
				bytesCount = readBinaryData.read(b);
			}
			
			
			System.out.println(empId);
			System.out.println(empName);
			System.out.println(empAge);
			
			
			
			
		}
	}

}
